(this.$WP=this.$WP||[]).push(["NkmoMN",(e,t)=>{"use strict";var n,i,s,a,r,l,o,u,d,c,m,p,v,_,g,S,k,f,I,b,C,h,y,P,M,w,E,N,R=()=>m.get("interstitialPageViews")||0,U=()=>m.get("interstitialDelayPageViews")||0,T=()=>m.get("previouslyIntervalSeenInterstitial")||!1,V=()=>m.get("previouslyTotalSeenInterstitial")||0,x=()=>p.get("sessionPreviouslySeenInterstitial")||0,D=()=>m.get("previouslyIntervalSeenInterstitialGhost")||!1,O=()=>m.get("previouslyTotalSeenInterstitialGhost")||0,A=()=>p.get("sessionPreviouslySeenInterstitialGhost")||0,F=({children:e,onShow:t,delaySeconds:i,delayPageViews:s,afterPageViews:a,maxSeen:r,maxSeenSession:l,variantName:u,isDatePickerOpen:d,suppress:c,ignoreInterval:_,onSkip:g,fallback:S=null,isControl:k=!1})=>{var f=n.useMemo(R,[]),I=n.useMemo(U,[]),C=n.useMemo(T,[]),h=n.useMemo(V,[]),y=n.useMemo(x,[]),P=n.useMemo(D,[]),M=n.useMemo(O,[]),w=n.useMemo(A,[]),[E,N]=n.useState(!1),[,{uid:F}]=n.useContext(o),G=v();n.useEffect(()=>{!_&&C||m.set("interstitialPageViews",f+1)},[f,C,_]),n.useEffect(()=>{(c||d)&&N(!1)},[c,d]);var H=n.useMemo(()=>!d&&f>=a&&(_||!C)&&h<r&&y<l,[d,f,a,C,h,y,r,l,_]);return n.useEffect(()=>{!H&&g&&g()},[H,g]),n.useEffect(()=>{var e=I<s;if(H){e&&m.set("interstitialDelayPageViews",I+1);var n=setTimeout(()=>{document.querySelector('[title="regcontroller"]')||document.getElementById("explicitPreferences")||((_||!P)&&w<l&&h<r&&H&&!d&&(G({optimusMarketingInterstitial:{name:k?"control_"+u:u,pageviewUid:F}}),k&&(p.set("sessionPreviouslySeenInterstitialGhost",w+1),m.set("previouslyIntervalSeenInterstitialGhost",!0,b),m.set("previouslyTotalSeenInterstitialGhost",M+1))),c||!H||d||(p.set("sessionPreviouslySeenInterstitial",y+1),m.set("previouslyIntervalSeenInterstitial",!0,b),m.set("previouslyTotalSeenInterstitial",h+1),N(!0),t&&t()))},e?1e3*i:0);return()=>clearTimeout(n)}return()=>{}},[H,N,i,s,I,y,w,h,M,P,r,l,d,t,c,G,F,u,k,_]),E?e:S},G="SUMMER25",H="SUMMER50",L="SUMMER75",q=["Attractions","AttractionsFusion","AttractionsHome","AttractionProductReview","Attraction_Review","CheapFlightsHome","Cruises","Flights","Hotels","HotelsHome","HotelsList","HotelsNear","Hotel_Review","LocationPhotoDirectLink","RentalCars","RentalCarsGeo","Rentals","Restaurants","ShowForum","ShowTopic","ShowUserReviews","SmartDeals","Tourism","VacationRentals"],B=(e,t)=>{var{userId:n}=i(u),{fetching:s,totalUgc:a}=(e=>{var t,n,i,[{fetching:s,data:a,error:r}]=I({query:C,variables:{userId:{id:e}},pause:!e});return{fetching:s,totalUgc:(null==a||null==(t=a.memberProfiles)||null==(n=t[0])||null==(i=n.contributionCounts)?void 0:i.sumAllUgc)||0,error:r}})(n);return s?null:"min"===t?a>=e:a<=e},K=()=>{var[{page:e,params:t}]=i(o),n=t.discountCode||null,s=!("Plus"!==e||!t.autopop&&""!==t.autopop||!n),a="Plus"===e&&null!==t.autopop&&"SUMMER0"===t.autopop;return s||a},Q=()=>{var e=K(),[{params:t}]=i(o);if(!e)return null;var n=t.discountCode||null;switch(n){case G:return"low_discount";case H:return"medium_discount";case L:return"high_discount"}if(null===n)switch(t.autopop||null){case"SUMMER0":return"edu_endless"}return null},X=({delaySeconds:e,afterPageViews:t,delayPageViews:s,maxSeen:l,maxSeenSession:d,isDatePickerOpen:m,onPopupDismiss:p,onOpen:v,onClose:f,fallback:I=null})=>{var{isOptimusEnabled:b,isOptimusSubscribed:C}=g(),[R,U]=n.useState(!0),[{page:T,params:V}]=n.useContext(o),x=V.discountCode||null,D=(()=>{var e,{userId:t}=i(u),n=Q(),s=(()=>{var e=Q(),t=r("optimus_discount_interstitial"),n=K();return t&&n&&!e})(),a=r("optimus_discount_interstitial"),l=B(2,"min"),d=(()=>{var e=B(1,"max"),[{page:t,params:n}]=i(o),s=n.discountCode||null;return null===e?null:!("Plus"===t&&![null,G,H,L].includes(s))})(),c=(()=>{var[{page:e}]=i(o);return["OptimusHotelCheckout","OptimusSubscriptionCheckout"].includes(e)})();l?e="plus_discount_campaign_1623875391":d&&(e="plus_discount_campaign_phase_2_1625667802");var m=[];e&&m.push(e);var p=k({experimentKeys:m,userId:t||void 0,skipImpression:c||!a||null===l||null===d});if(!a||c)return"";if(null===p||null===s||null===l||null===d)return null;var v=e?p[e]:null;return"plus_discount_campaign_1623875391"===e&&P.includes(v)&&!l||"plus_discount_campaign_phase_2_1625667802"===e&&M.includes(v)&&!d?"":n||(s?"test_bubble":"plus_discount_campaign_phase_2_1625667802"===e&&"control"===v?"edu_endless":v||"")})(),O=K(),{funnelKey:A}=i(c),X=_({members:S("/OptimusAccountManager"),nonMembers:S("/OptimusSubscriptionCheckout?oik="+A)}),J=a(({variantName:e})=>{"endless"===e?X():U(!1)},[X]),W=a(()=>{f&&f(),p&&p(),U(!1)},[f,p]),$=()=>(p&&p(),I);if(null===D)return null;if("control"===D)return $();if(!b||C||!D&&!E&&!N)return $();var j=D;if(""===j){if(!E&&!N)return $();j="optimus_brand_interstitial"}if(!j)return $();var Z=(({variant:e,discountCode:t,onInterstitialClose:i,onInterstitialCta:s})=>w.includes(e)?(({variant:e,onInterstitialClose:t,onInterstitialCta:i})=>{var s;switch(e){case"edu_endless":s="endless";break;case"optimus_brand_interstitial":default:s="swimming"}return n.createElement(y,{variant:s,onClose:()=>t(),onCtaClick:e=>i({variantName:e,isDiscount:!1}),dataAutomationTag:"plusMarketingInterstitial"})})({variant:e,onInterstitialClose:i,onInterstitialCta:s}):(({variant:e,discountCode:t,onInterstitialClose:i,onInterstitialCta:s})=>{var a,r=null==t?void 0:t.toUpperCase();switch(e){case"test_bubble":a="community";break;case"test_cactus":a="savings";break;case"low_discount":a="endless_a",r="SUMMER25";break;case"medium_discount":a="endless_b",r="SUMMER50";break;case"high_discount":a="endless_c",r="SUMMER75";break;default:throw new Error("Discount interstitial not implemented for variant "+e)}return n.createElement(h,{code:r||"25OFF",onClose:()=>i(),onCtaClick:e=>s({variantName:e,isDiscount:!0}),variant:a,dataAutomationTag:"plusMarketingInterstitial"})})({variant:e,discountCode:t,onInterstitialClose:i,onInterstitialCta:s}))({variant:j,discountCode:x,onInterstitialClose:W,onInterstitialCta:J}),z="optimus_brand_interstitial"===j&&(E&&!q.includes(T)||N);return n.createElement(F,{delaySeconds:e,delayPageViews:O?0:s,afterPageViews:t,maxSeen:O?Number.MAX_SAFE_INTEGER:l,maxSeenSession:O?Number.MAX_SAFE_INTEGER:d,variantName:j,isDatePickerOpen:m,onSkip:p,suppress:z,ignoreInterval:O,onShow:v,fallback:I,isControl:N},R?Z:I)},J=e=>{var[t]=s(l());return n.createElement(d,{funnelKey:t},n.createElement(X,e))};return[()=>{b=864e5,(C=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"UserGeneratedContent"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"UserIdInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"memberProfiles"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"userIds"},"value":{"kind":"ListValue","values":[{"kind":"Variable","name":{"kind":"Name","value":"userId"}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"contributionCounts"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"sumAllUgc"},"arguments":[],"directives":[]}]}}]}}]}}],"loc":{"start":0,"end":152}}')).__key=0x8aea4a23c3f4,h=f.component.onUsage(()=>t("_MrER3"),"default"),y=f.component.onUsage(()=>t("NkmoMN/Oi3Clo"),"BrandEducationInterstitial"),P=["control","test_bubble","test_cactus"],M=["control","low_discount","medium_discount","high_discount"],w=["edu_endless","optimus_brand_interstitial"],E=r("optimus_edu_interstitial"),N=r("optimus_edu_interstitial_control"),J.defaultProps={delaySeconds:30,afterPageViews:0,delayPageViews:1,maxSeen:3,maxSeenSession:1},e("default",J)},[e=>(n=e.default,i=e.useContext,s=e.useState,a=e.useCallback),e=>r=e.featureIsEnabled,e=>l=e.uuid,e=>(o=e.Route,u=e.Visitor),e=>(d=e.FunnelTrackingProvider,c=e.FunnelTracking),e=>m=e.default,e=>p=e.default,e=>v=e.useImpressionLogger,e=>_=e.useOptimusLoginNavigation,e=>g=e.useOptimusEnabledForUser,e=>S=e.needsRouting,e=>k=e.default,e=>f=e,e=>I=e.useQuery]]},["cDcdfi","-i3PJS","O-HcBE","2R4xv2","ETqDaL","jaCyxS","qKFflQ","30t50h","mT-Pb2","v_y45t","oPZBqR","S-RL4Q","pLbCP4","5X2em-"]]);
